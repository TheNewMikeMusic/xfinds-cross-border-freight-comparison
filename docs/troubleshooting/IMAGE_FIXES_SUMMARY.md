# å›¾ç‰‡ç ´å›¾é—®é¢˜æ£€æŸ¥æ€»ç»“

## ğŸ” æ£€æŸ¥ç»“æœ

è¿è¡Œ `node scripts/check-image-issues.js` åå‘ç°çš„é—®é¢˜ï¼š

### 1. æ–‡ä»¶ååŒ…å«ç©ºæ ¼ (3ä¸ª)
- `prod-13`: `/Nasa stusy.png`, `/Nasa stusy2.png`, `/Nasa stusy3.png`
- **é£é™©**: âš ï¸ ä¸­ç­‰ - URLç¼–ç é—®é¢˜ï¼ŒLinuxæœåŠ¡å™¨å¯èƒ½404

### 2. è·¯å¾„ä¸ä¸€è‡´ (2ä¸ª)
- `prod-25`: `/gr-y29-earbuds.png` åº”è¯¥ä½¿ç”¨ `/images/gr-y29-earbuds.png`
- **é£é™©**: âš ï¸ ä½ - ä¸ä¼šç›´æ¥å¯¼è‡´ç ´å›¾ï¼Œä½†å»ºè®®ç»Ÿä¸€

## ğŸ“‹ å¯èƒ½å¯¼è‡´ç ´å›¾çš„å®Œæ•´åŸå› 

### é«˜ä¼˜å…ˆçº§é—®é¢˜

1. **æ–‡ä»¶ååŒ…å«ç©ºæ ¼**
   - é—®é¢˜: URLéœ€è¦ç¼–ç ä¸º `%20`
   - å½±å“: LinuxæœåŠ¡å™¨å¤§å°å†™æ•æ„Ÿï¼Œå¯èƒ½å¯¼è‡´404
   - ä½ç½®: `prod-13` çš„NASAå•†å“å›¾ç‰‡

2. **è·¯å¾„å¤§å°å†™æ•æ„Ÿ**
   - é—®é¢˜: Windowsä¸åŒºåˆ†ï¼ŒLinuxåŒºåˆ†
   - å½±å“: éƒ¨ç½²åˆ°LinuxæœåŠ¡å™¨åå¯èƒ½404
   - æ£€æŸ¥: æ‰€æœ‰è·¯å¾„åº”ä½¿ç”¨å°å†™

3. **æ–‡ä»¶ä¸å­˜åœ¨**
   - é—®é¢˜: å›¾ç‰‡æ–‡ä»¶æœªä¸Šä¼ æˆ–è·¯å¾„é”™è¯¯
   - å½±å“: ç›´æ¥å¯¼è‡´404é”™è¯¯
   - æ£€æŸ¥: è¿è¡Œæ£€æŸ¥è„šæœ¬éªŒè¯

### ä¸­ä¼˜å…ˆçº§é—®é¢˜

4. **è·¯å¾„ä¸ä¸€è‡´**
   - é—®é¢˜: æœ‰äº›ç”¨ `/images/`ï¼Œæœ‰äº›ç”¨ `/`
   - å½±å“: ç»´æŠ¤å›°éš¾ï¼Œä½†ä¸ä¼šç›´æ¥ç ´å›¾
   - å»ºè®®: ç»Ÿä¸€ä½¿ç”¨ `/images/` å‰ç¼€

5. **Next.js Imageç»„ä»¶è·¯å¾„ç¼–ç **
   - é—®é¢˜: å½“å‰ä»£ç æœªä½¿ç”¨ `encodeImagePath`
   - å½±å“: ç‰¹æ®Šå­—ç¬¦è·¯å¾„å¯èƒ½å‡ºé”™
   - è§£å†³: ä½¿ç”¨ `SafeImage` ç»„ä»¶

6. **å›¾ç‰‡ä¼˜åŒ–å¤±è´¥**
   - é—®é¢˜: Next.jså›¾ç‰‡ä¼˜åŒ–å¯èƒ½å¤±è´¥
   - å½±å“: å›¾ç‰‡æ— æ³•æ˜¾ç¤º
   - æ£€æŸ¥: `next.config.js` é…ç½®

### ä½ä¼˜å…ˆçº§é—®é¢˜

7. **æ–‡ä»¶æƒé™**
   - é—®é¢˜: Linuxæ–‡ä»¶æƒé™ä¸è¶³
   - å½±å“: 403é”™è¯¯
   - è§£å†³: `chmod 644` è®¾ç½®æƒé™

8. **CDNç¼“å­˜**
   - é—®é¢˜: æ—§ç‰ˆæœ¬å›¾ç‰‡è¢«ç¼“å­˜
   - å½±å“: æ˜¾ç¤ºæ—§å›¾ç‰‡æˆ–404
   - è§£å†³: æ¸…é™¤CDNç¼“å­˜

9. **CORSé—®é¢˜**
   - é—®é¢˜: è·¨åŸŸå›¾ç‰‡è¢«é˜»æ­¢
   - å½±å“: å¤–éƒ¨å›¾ç‰‡æ— æ³•åŠ è½½
   - æ£€æŸ¥: æµè§ˆå™¨æ§åˆ¶å°é”™è¯¯

## ğŸ”§ ä¿®å¤æ­¥éª¤

### ç«‹å³ä¿®å¤ï¼ˆå¿…é¡»ï¼‰

1. **é‡å‘½åNASAå›¾ç‰‡æ–‡ä»¶**
   ```bash
   cd public
   mv "Nasa stusy.png" "nasa-stusy.png"
   mv "Nasa stusy2.png" "nasa-stusy-2.png"
   mv "Nasa stusy3.png" "nasa-stusy-3.png"
   ```

2. **æ›´æ–° products.json**
   ```json
   {
     "id": "prod-13",
     "cover": "/nasa-stusy.png",
     "gallery": [
       "/nasa-stusy-2.png",
       "/nasa-stusy-3.png"
     ]
   }
   ```

3. **ç»Ÿä¸€è€³æœºå›¾ç‰‡è·¯å¾„**
   ```json
   {
     "id": "prod-25",
     "cover": "/images/gr-y29-earbuds.png",
     "gallery": [
       "/images/gr-y29-earbuds-2.png"
     ]
   }
   ```

### å»ºè®®æ”¹è¿›ï¼ˆå¯é€‰ï¼‰

4. **ä½¿ç”¨ SafeImage ç»„ä»¶**
   - å·²åˆ›å»º `components/shared/safe-image.tsx`
   - è‡ªåŠ¨å¤„ç†è·¯å¾„ç¼–ç å’Œé”™è¯¯å¤„ç†
   - é€æ­¥æ›¿æ¢ç°æœ‰ `Image` ç»„ä»¶

5. **æ·»åŠ å›¾ç‰‡éªŒè¯**
   - åœ¨æ„å»ºæ—¶éªŒè¯å›¾ç‰‡å­˜åœ¨æ€§
   - æ·»åŠ CI/CDæ£€æŸ¥æ­¥éª¤

## âœ… éƒ¨ç½²å‰æ£€æŸ¥æ¸…å•

- [ ] è¿è¡Œ `node scripts/check-image-issues.js` æ— ä¸¥é‡é”™è¯¯
- [ ] æ‰€æœ‰å›¾ç‰‡æ–‡ä»¶å·²ä¸Šä¼ åˆ°æœåŠ¡å™¨
- [ ] æ–‡ä»¶åä¸åŒ…å«ç©ºæ ¼å’Œç‰¹æ®Šå­—ç¬¦
- [ ] è·¯å¾„ç»Ÿä¸€ä½¿ç”¨å°å†™å­—æ¯
- [ ] ç»Ÿä¸€ä½¿ç”¨ `/images/` å‰ç¼€ï¼ˆé™¤äº†ç‰¹æ®Šæ–‡ä»¶ï¼‰
- [ ] éªŒè¯å›¾ç‰‡æ–‡ä»¶æƒé™ï¼ˆLinux: 644ï¼‰
- [ ] æµ‹è¯•å›¾ç‰‡åŠ è½½ï¼ˆæœ¬åœ°å’ŒæœåŠ¡å™¨ï¼‰
- [ ] æ£€æŸ¥æµè§ˆå™¨æ§åˆ¶å°æ— 404é”™è¯¯
- [ ] éªŒè¯Next.js Imageä¼˜åŒ–æ­£å¸¸å·¥ä½œ

## ğŸš€ éªŒè¯å‘½ä»¤

```bash
# 1. æ£€æŸ¥å›¾ç‰‡é—®é¢˜
node scripts/check-image-issues.js

# 2. éªŒè¯JSONæ ¼å¼
node -e "JSON.parse(require('fs').readFileSync('data/products.json', 'utf8')); console.log('JSON valid')"

# 3. æ£€æŸ¥æ–‡ä»¶å­˜åœ¨æ€§ï¼ˆLinuxï¼‰
find public -name "*.png" -o -name "*.jpg" | sort

# 4. æ£€æŸ¥æ–‡ä»¶æƒé™ï¼ˆLinuxï¼‰
find public -type f -name "*.png" -exec ls -l {} \;
```

## ğŸ“š ç›¸å…³æ–‡æ¡£

- `docs/troubleshooting/image-issues.md` - è¯¦ç»†é—®é¢˜è¯´æ˜
- `scripts/check-image-issues.js` - æ£€æŸ¥è„šæœ¬
- `components/shared/safe-image.tsx` - å®‰å…¨çš„Imageç»„ä»¶


